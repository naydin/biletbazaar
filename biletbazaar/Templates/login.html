{% extends "base.html" %}
{% load staticfiles %}


{% block title %}biletal3 - Bilet Boşta Kalmasın{% endblock %}
    
    
{% block css_js_links %}
	<link href="{% static 'css/login.css' %}" rel="stylesheet" type="text/css" /> 

 	
{% endblock %}
    



{% block js_functions %} 

	function post_to_url(path, params, method) {
	    method = method || "post"; // Set method to post by default if not specified.

	    // The rest of this code assumes you are not using a library.
	    // It can be made less wordy if you use one.
	    var form = document.createElement("form");
	    form.setAttribute("method", method);
	    form.setAttribute("action", path);

	    for(var key in params) {
	        if(params.hasOwnProperty(key)) {
	            var hiddenField = document.createElement("input");
	            hiddenField.setAttribute("type", "hidden");
	            hiddenField.setAttribute("name", key);
	            hiddenField.setAttribute("value", params[key]);

	            form.appendChild(hiddenField);
	         }
	    }

	    document.body.appendChild(form);
	    form.submit();
	}
	
	function fbLogin() {
	  FB.login(function(response) {
		  // {% if not user.is_authenticated %}
				post_to_url("http://www.biletbosta.com/fb_login/",{"access_token":response.authResponse.accessToken,"next":document.URL},"POST");
		  // {% endif %}
	    if (response.session) {

	      //user is logged in, reload page
	      // window.location.reload(true);

		  
	    } else {
	      // user is not logged in
	    }
	  }, {perms:['email','user_online_presence','offline_access']});
	}
	window.fbAsyncInit = function() {
	  FB.init({
	    appId      : '1384694118463559',
	    status     : true, // check login status
	    cookie     : true, // enable cookies to allow the server to access the session
	    xfbml      : true  // parse XFBML
	  });

	  // Here we subscribe to the auth.authResponseChange JavaScript event. This event is fired
	  // for any authentication related change, such as login, logout or session refresh. This means that
	  // whenever someone who was previously logged out tries to log in again, the correct case below 
	  // will be handled. 
	  FB.Event.subscribe('auth.authResponseChange', function(response) {
	    // Here we specify what we do with the response anytime this event occurs. 
	    if (response.status === 'connected') {
	      // The response object is returned with a status field that lets the app know the current
	      // login status of the person. In this case, we're handling the situation where they 
	      // have logged in to the app.
		  // window.alert(response.authResponse.accessToken);
		  // response.authResponse.userID
	      testAPI();
		  // {% if not user.is_authenticated %}
// 			post_to_url("/fb_login/",{"access_token":response.authResponse.accessToken,"next":document.URL},"POST");
// 		  {% endif %}

	    } else if (response.status === 'not_authorized') {
	      // In this case, the person is logged into Facebook, but not into the app, so we call
	      // FB.login() to prompt them to do so. 
	      // In real-life usage, you wouldn't want to immediately prompt someone to login 
	      // like this, for two reasons:
	      // (1) JavaScript created popup windows are blocked by most browsers unless they 
	      // result from direct interaction from people using the app (such as a mouse click)
	      // (2) it is a bad experience to be continually prompted to login upon page load.
		  // window.alert('not_authorized');
	      // fbLogin();
	    } else {
	      // In this case, the person is not logged into Facebook, so we call the login() 
	      // function to prompt them to do so. Note that at this stage there is no indication
	      // of whether they are logged into the app. If they aren't then they'll see the Login
	      // dialog right after they log in to Facebook. 
	      // The same caveats as above apply to the FB.login() call here.
		  // window.alert('else');
	      // fbLogin();
	    }
	  });
	  };

	  // Load the SDK asynchronously
	  (function(d){
	   var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
	   if (d.getElementById(id)) {return;}
	   js = d.createElement('script'); js.id = id; js.async = true;
	   js.src = "//connect.facebook.net/en_US/all.js";
	   ref.parentNode.insertBefore(js, ref);
	  }(document));

	  // Here we run a very simple test of the Graph API after login is successful. 
	  // This testAPI() function is only called in those cases. 
	  function testAPI() {
	    console.log('Welcome!  Fetching your information.... ');
	    FB.api('/me', function(response) {
	      console.log('Good to see you, ' + response.name + '.');
	    });
	  }

$(document).ready(function() {
    var triggers = $(".modalInput").overlay({

      // some mask tweaks suitable for modal dialogs
      mask: {
        color: '#FFF',
        loadSpeed: 200,
        opacity: 0.9
      },

      closeOnClick: false
  });
  
  
  
    $("#prompt form").submit(function(e) {

      // do not submit the form
      <!-- return e.preventDefault(); -->
  });
  });






  $(function() {

        // select all desired input fields and attach tooltips to them
      $("#myform :input").tooltip({

      // place tooltip on the right edge
      position: "center right",

      // a little tweaking of the position
      offset: [-2, 20],

      // use the built-in fadeIn/fadeOut effect
      effect: "fade",

      // custom opacity setting
      opacity: 0.7

      });
    });
  
  
    function validate(theForm) { // passing the form object
 	var val1=document.forms["myform"]["koltuk_no"].value;
	var val2=document.forms["myform"]["bilet_sayisi"].value;
	var flag = 0;
  if (val1==null || val1.trim()=="") { 
    
	document.getElementById('koltuk_uyari').innerHTML = '*Gerekli alan'
	flag =1
    
  }
  if (val2==null || val2.trim()=="" ||val2=="bilet sayısını giriniz") { 
    
	document.getElementById('biletsayisi_uyari').innerHTML = '*Gerekli alan'
	flag=1
    
  }
  if(flag==1){
	  return false;
	
  }
  return true; // allow submit
}














{% endblock %}

{% block content %}


       	
        <div class="uyelik">	
         	<div class="login" >
            	<span style="font-size:22px; color:#3496af; margin-left:40px; display:inline-block; margin-top:30px;">üye girişi</span>
                <br /><br /><br />
                <div class="fb_giris">
                <a style="margin-left:40px; vertical-align:bottom" href=""><img src="{% static 'resimler/fb_login.png' %}" onclick="fbLogin();"/></a>
                <span style="margin-left:10px;display: inline-block;vertical-align: top; font-size:16px" >facebook yoluyla giriş yap</span>
                 <span style="font-size:30px; margin-left:140px;">veya</span>
                </div>
                
                 <form id="myform" name="bilet_detaylari" method="post" onsubmit="return validate(this)">
         			<label class="name" style="font-size:20px;margin-left:10px; margin-bottom:20px; margin-right:40px;float:left;">e-posta</label>
   					<input name="username" id="isim_tb" class="tb" type="text"  />
                    <label id="isim_lb" style="color:#bdd531; float:right; margin-right:5px;">{{login_username_error}}</label> 
                    
                    <br />
                    <label class="name" style="font-size:20px; margin-left:10px;margin-bottom:20px; margin-right:40px; float:left;">şifre </label>
   					<input name="password" id="soyisim_tb" class="tb" type="text" />
                    <label id="soyisim_lb" style="color:#bdd531; float:right; margin-right:5px;">{{login_password_error}}</label>
                    
                    <br />
					{% csrf_token %}
                    <button type="submit" name ="login_form" class="button_example" style="float:right; margin-right:15px; margin-left:150px; margin-bottom:20px;">giriş</button>
                    <br />
                    <a id="unuttum" href="" class="modalInput" rel="#prompt" style="float:right; margin-right:15px; color:#aabf2c">şifremi unuttum</a>
                    


        		</form>
        		
			</div>
			
			
			
			
			
			
			
			
        	<div class="signup" >
       		  	<span style="font-size:22px; color:#3496af; margin-left:40px; display:inline-block; margin-top:30px;">kaydol</span>
                <br /><br /><br />
                <div class="fb_giris2">
                <a style="margin-left:40px; vertical-align:bottom" href=""><img src="{% static 'resimler/fb_login.png' %}" onclick="fbLogin();"/></a>
                <span style="margin-left:10px;display: inline-block;vertical-align: top; font-size:16px">facebook yoluyla kaydol</span>
                <span style="font-size:30px; margin-left:140px;">veya</span>
                </div>
                
                <form id="myform" name="bilet_detaylari" method="post" onsubmit="return validate(this)">
         			<label class="name" style="font-size:20px;margin-left:10px; margin-bottom:20px; margin-right:40px;float:left;">ad</label>
   					<input name="name" id="isim_tb" class="tb" type="text" title="Bilet ilanını veren kişinin adını giriniz." />
                    <label id="isim_lb" style="color:#bdd531; float:right; margin-right:5px;">{{signup_name_error}}</label> 
                    
                    <br />
                    <label class="name" style="font-size:20px; margin-left:10px;margin-bottom:20px; float:left;">soyad </label>
   					<input name="surname" id="soyisim_tb" class="tb" type="text" title="Bilet ilanını veren kişinin soyadını giriniz." />
                    <label id="soyisim_lb" style="color:#bdd531; float:right; margin-right:5px;">{{signup_surname_error}}</label>
                    
                    
                    <br />
                    <label class="name" style="font-size:20px; margin-left:10px;margin-bottom:20px;float:left; margin-right:40px;">e-posta </label>
   					<input name="username" id="sehir_tb" class="tb" type="text" title="Biletin teslim alınacağı ili giriniz."  />
                    <label id="sehir_lb" style="color:#bdd531; float:right; margin-right:5px;">{{signup_username_error}}</label>
                    

                    <br />
                    <label class="name" style="font-size:20px; margin-left:10px;margin-bottom:20px;float:left;">sifre</label> 
   					<input name="password" id="adres_tb" class="tb" type="text" title="Lütfen biletin teslim alınacağı açık adresi giriniz." />
                    <label id="adres_lb" style="color:#bdd531; float:right; margin-right:5px;">{{signup_password_error}}</label>
                    
                    <br />
                    <label class="name" style="font-size:20px; margin-left:10px;margin-bottom:20px;float:left;">sifre tekrar</label> 
   					<input name="password_again" id="adres_tb" class="tb" type="text" title="Lütfen biletin teslim alınacağı açık adresi giriniz." />
                    <label id="adres_lb" style="color:#bdd531; float:right; margin-right:5px;">{{signup_password_again_error}}</label>
                    
                     <br />
                    <label class="name" style="font-size:20px; margin-left:10px;margin-bottom:20px;float:left;">cep telefonu</label> 
   					<input name="gsm" id="adres_tb" class="tb" type="text" title="Lütfen biletin teslim alınacağı açık adresi giriniz." />
                    <label id="adres_lb" style="color:#bdd531; float:right; margin-right:5px;">{{signup_gsm_error}}</label>
                    
                    <br />
					{% csrf_token %}
                    <button type="submit" name='signup_form' class="button_example" style="float:right; margin-right:5px;">kaydol</button>
        		</form>
       	  </div>
      </div>
      
      <!-- user input dialog -->
				<div class="modal" id="prompt">
  					<h2>Şifremi Unuttum</h2>
 
					  <p>
					    Şifreniz girilen email adresine gönderilecektir.
					  </p>
 
					  <!-- input form. you can press enter too -->

					  <form action="/login/" method="POST">
					    <input name="username"/>
						{% csrf_token %}
					    <input type="submit" name="forgot_password_form" value='Gönder'>
					    <button type="button" class="close"> İptal </button>
					  </form>
					  <br />
 
				</div>
      
{% endblock %}
